---
draft: false
date: 2023-07-13 08:00:00 +0800
title: "整数的运算（笔记片段）"
summary: "整数的四则运算；"
toc: true

categories:
  - programming-language(编程语言)

tags:
  - computer-science(计算机科学)
  - programming-language(编程语言)
  - assembly-language(汇编语言)
---

## 前言

这篇笔记需要 intel x86-64 架构、数据传输、流程控制、gdb 调试相关的知识。

实践的环境：同 [x86-64_架构]()

## 资料

笔记里的代码都在 {demo-assembly}/demo-in-linux/integer/ 目录下。

## 正文

### add

add 可以实现整数的加法运算。`add {源操作数}, {目的操作数}`。
将源操作数和目的操作数相加，然后，将结果存储到目的操作数中。

源操作数可以是立即数、寄存器、内存位置。目的操作数可以是寄存器、内存位置。
但是，一条指令中不能使用两个内存操作数。

add 会自动分析操作数是有符号还是无符号。
如果产生进位（溢出），有符号结果会设置 OF 标志，无符号结果会设置 CF 标志。
SF 标志表示有符号结果的符号。

代码示例：{demo-assembly}/demo-in-linux/integer/add.asm

### adc

adc 可以实现整数的加法运算。`adc {源操作数}, {目的操作数}`。
将源操作数、目的操作数、cf 标志位相加，然后，将结果存储到目的操作数中。
cf 标志位代表上一条加法的进位。

源操作数可以是立即数、寄存器、内存位置。目的操作数可以是寄存器、内存位置。

adc 会自动分析操作数是有符号还是无符号。
如果产生溢出（溢出），有符号结果会设置 OF 标志，无符号结果会设置 CF 标志。
SF 标志表示有符号结果的符号。

代码示例：{demo-assembly}/demo-in-linux/integer/adc.asm

### sub

sub 可以实现整数的减法运算。`sub {源操作数}, {目的操作数}`。
将目的操作数与源操作数相减，并将结果存储到目的操作数中。

目的操作数可以是寄存器、内存位置。源操作数可以是立即数、寄存器、内存位置。
但是，一条指令中不能使用两个内存操作数。

sub 会自动分析操作数是有符号还是无符号。
如果产生借位（溢出），有符号结果会设置 OF 标志，无符号结果会设置 CF 标志。
SF 标志表示有符号结果的符号。

代码示例：{demo-assembly}/demo-in-linux/integer/sub.asm

### sbb

sbb 可以实现整数的减法运算。`sbb {源操作数}, {目的操作数}`。
用目的操作数减（源操作数和 cf 标志之和），结果存入目的操作数。

目的操作数可以是寄存器、内存位置；源操作数可以是立即数、寄存器、内存位置。

sbb 会自动分析操作数是有符号还是无符号。
如果产生借位（溢出），有符号结果会设置 OF 标志，无符号结果会设置 CF 标志。
SF 标志表示有符号结果的符号。

代码示例：{demo-assembly}/demo-in-linux/integer/sbb.asm

### mul

mul 可以实现无符号整数的乘法运算。`mul {源操作数}`。
目的操作数要先放到 al、ax、eax、rax 里面去。
执行源操作数和目的操作数的无符号乘法运算，结果存入目的操作数。

源操作数可以是寄存器、内存位置。

代码示例：{demo-assembly}/demo-in-linux/integer/mul.asm

当目的操作数的寄存器放不下乘积的结果的时候，数据会被拆成两部分放到两个寄存器里去。具体细节看文档。
比如，无符号的 0xffffffff 已经把 eax 塞满了。这个时候再 x2，其结果 0x1fffffffe 需要 33 位的空间。
eax 不够放了，这个时候就会把数据拆成两部分。后面的 32 位（0xfffffffe）放在 eax，前面剩下的数据（0x1）放在 edx。

### imul

imul 可以实现有符号整数的乘法运算。该指令有三种形式，取决于操作数。

单操作数形式，`imul {源操作数}`。这种形式与 mul 指令相同。

双操作数形式，`imul {目的操作数}, {源操作数}`。
执行源操作数和目的操作数的有符号乘法运算。结果会被截断，并存储在目的操作数。
目的操作数是通用寄存器。源操作数可以是立即数、寄存器、内存位置。

三操作数形式，`imul {立即数}, {源操作数}, {目的操作数}`。
执行源操作数和立即数的有符号乘法运算。结果会被截断，并存储在目的操作数。
目的操作数是通用寄存器。源操作数可以是通用寄存器、内存位置。

代码示例：{demo-assembly}/demo-in-linux/integer/imul.asm

### div

div 可以实现无符号整数的除法运算。

### idiv

idiv 可以实现有符号整数的除法运算。
