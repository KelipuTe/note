<!doctype html><html lang=zh-cn data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.103.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="程序"><meta itemprop=description content><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/image/pid49256268.jpg"><meta itemprop=keywords content="computer-science(计算机科学),operating-system(操作系统)"><meta property="og:type" content="article"><meta property="og:title" content="程序"><meta property="og:description" content><meta property="og:image" content="/image/pid49256268.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/post/computer-science/operating-system/program/"><meta property="og:site_name" content="帕里特档案馆"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="西柊慧音"><meta property="article:published_time" content="2023-06-10 08:00:00 +0800 CST"><meta property="article:modified_time" content="2023-06-10 08:00:00 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.4da9279b6033ade10d67092d7bfb660265f9fa46c40974f17b13bfe235396546.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"program","permalink":"/post/computer-science/operating-system/program/","title":"程序","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>程序 - 帕里特档案馆</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>帕里特档案馆</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>重建中</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>87</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#资料>资料</a></li><li><a href=#正文>正文</a><ul><li><a href=#什么是程序>什么是程序</a></li><li><a href=#从源代码到可执行文件>从源代码到可执行文件</a><ul><li><a href=#实践的环境>实践的环境</a></li><li><a href=#在-linux-中使用-c-语言进行编程的注意点postcomputer-scienceoperating-systemlinuxnotice><a href=/post/computer-science/operating-system/linux/notice>在 Linux 中使用 C 语言进行编程的注意点</a></a></li><li><a href=#编译>编译</a></li></ul></li><li><a href=#编译过程产生的几个文件>编译过程产生的几个文件</a></li><li><a href=#可执行文件>可执行文件</a></li><li><a href=#程序的运行过程是怎样的>程序的运行过程是怎样的</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=西柊慧音 src=/imgs/img-lazy-loading.gif data-src=/image/pid49256268.jpg><p class=site-author-name itemprop=name>西柊慧音</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>87</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>16</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>62</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/KelipuTe title="Github → https://github.com/KelipuTe" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span>
<span class=links-of-social-item><a href=xhy_1365@sina.com title="E-Mail → xhy_1365@sina.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>E-Mail</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/post/computer-science/operating-system/program/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/image/pid49256268.jpg"><meta itemprop=name content="西柊慧音"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="西柊慧音"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="程序"><meta itemprop=description content="什么是程序；从源代码到可执行文件；编译过程产生的几个文件；程序的运行过程是怎样的；"></span><header class=post-header><h1 class=post-title itemprop="name headline">程序</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text>发表于：</span>
<time title="发表于：2023-06-10 08:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-06-10 08:00:00 +0800 CST">2023-06-10</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/operating-system%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F itemprop=url rel=index><span itemprop=name>operating-system(操作系统)</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span><span>3451</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>7分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv data-path=/post/computer-science/operating-system/program/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=前言>前言</h2><p>实践的环境：</p><ul><li>amd64（x86_64）</li><li>windows 11</li><li>vmware workstation pro 16</li><li>ubuntu 22.04</li><li>linux version 5.19.0-41-generic</li><li>gcc version 11.3.0</li></ul><h2 id=资料>资料</h2><ul><li><a href=https://github.com/KelipuTe/demo-c title={demo-c} rel="noopener external nofollow noreferrer" target=_blank class=exturl>{demo-c}
<i class="fa fa-external-link-alt"></i>
</a>/demo-in-linux/program/</li></ul><h2 id=正文>正文</h2><h3 id=什么是程序>什么是程序</h3><p>程序是计算机可以执行的一条或者一组指令，不管怎样，程序最终要在计算机物理硬件上跑起来的。</p><p>程序有很多种形态：计算机可以直接执行，但是，不方便开发人员阅读和处理的二进制机器码是程序；
计算机不能直接执行，但是，方便开发人员阅读和处理的由各种编程语言编写的源代码也是程序。</p><p>程序还有一种特别的形态，即由各种编程语言编写的源代码编译出来的可执行文件。
比如：windows 系统中 exe 可执行文件；linux 系统中的 elf 可执行文件。</p><p>那么问题来了，程序有这么多种形态，它们之间是怎么能正确的相互转化的？
答案是，通过抽象，而且是好多层的抽象。因为分类方式不同，会有不同的分层，所以下面说的，都是我的理解。</p><p>首先是，最上面的应用软件层和最下面的物理硬件层。
这两层比较好理解，应用软件层就是我们使用的各式各样的应用程序，物理硬件层就是这些应用程序最终运行时所依托的计算机物理硬件。</p><p>那么，中间有几层呢？这里不一定，我目前把中间分成 3 层。
操作系统肯定有一层，这个也好理解，我们使用计算机的时候都需要先安装一个操作系统。然后，在操作系统里面安装我们需要的应用程序。</p><p>一般来说，开发人员开发的应用程序是不能直接操作操作系统的，使用的是操作系统提供的系统接口。
开发人员通过操作系统提供的系统接口实现应用程序的功能。所以，这里有一层。</p><p>同理，开发人员开发的操作系统也是不能直接操作物理硬件的，使用的是物理硬件提供的固件接口。
固件是指嵌入硬件设备中的软件，开发人员通过固件接口开发操作系统。所以，这里也有一层。</p><h3 id=从源代码到可执行文件>从源代码到可执行文件</h3><p>对于应用软件的开发人员来说，一般都是基于操作系统进行开发的。所以，我这里的讨论，到操作系统就为止了。
不是说下层就不重要了，而是由于抽象层的存在，我们可以规避掉下层茫茫多的细节，专心讨论上层的问题。</p><p>上面提到过，开发人员开发的应用程序，使用的是操作系统提供的系统接口。系统接口也叫系统调用（system call）。
这个玩意，现在就解释有点太早了，在
<a href title="运行 ELF 文件">运行 ELF 文件</a> 这篇里面会详细的说。</p><h4 id=实践的环境>实践的环境</h4><p>这里，我借助 linux 系统和 c 语言来讨论这个问题。我这里实践的环境如下。
cpu 是 amd64（x86_64）架构，操作系统是 windows 11。这个可以通过 <code>systeminfo</code> 命令查看。</p><p>然后，在 windows 中，使用 vmware workstation pro 16，搭建 ubuntu 22.04 虚拟机。
ubuntu 22.04 的 linux 版本是 linux version 5.19.0-41-generic。这个可以通过 <code>cat /proc/version</code> 命令查看。</p><p>然后，在 linux 中安装 gcc 编译器，版本是 gcc version 11.3.0 (ubuntu 11.3.0-1ubuntu1~22.04)。</p><h4 id=在-linux-中使用-c-语言进行编程的注意点postcomputer-scienceoperating-systemlinuxnotice><a href=/post/computer-science/operating-system/linux/notice title="在 Linux 中使用 C 语言进行编程的注意点">在 Linux 中使用 C 语言进行编程的注意点</a></h4><h4 id=编译>编译</h4><p>可执行文件是操作系统提供的对于程序的抽象，内容包括程序指令和程序数据。
程序指令就是前面说过的指令集里面的指令，程序数据就是二进制的数据。
按照操作系统提供的对于程序的抽象编写出来的程序，操作系统才看得懂。</p><p>可执行文件就相当于一个操作手册，操作手册上记录了每一步要干什么。
手册上是用文字描述要干什么的，实际操作的时候，是一个个具体动作，指令集记录的就是文字描述和具体动作的对应关系。
操作系统拿着操作手册，再对照指令集，就可以知道需要在硬件系统上做什么具体动作。</p><p>想从源代码变成可执行文件，通常要进行编译。
在 linux 系统中就是，c 源码文件通过 gcc 编译器的编译得到 elf 可执行文件。
在 windows 系统中就是，c 源码文件通过 gcc 编译器的编译得到 exe 可执行文件。这里讨论的是在 linux 系统中的情况。</p><p>通常使用 gcc 命令 <code>gcc xxx.c -o xxx</code> 一步就完成了。但是，这一步里面其实有四个步骤：预处理、编译、汇编、链接。
关于 gcc 命令具体怎么用，可以看 &ldquo;gcc(1) - GNU project C and C++ compiler&rdquo;。</p><p>这里会用到 &ldquo;-E&rdquo;、"-S"、"-c"、"-o" 这几个参数。
&ldquo;-E&rdquo; 表示会进行预处理；"-S" 表示会进行预处理、编译，得到汇编代码；
&ldquo;-c&rdquo; 表示会进行预处理、编译、汇编，得到可重定位文件；"-o" 表示指定目标名称；
如果什么参数都不写，那就会预处理、编译、汇编、链接一步到位，得到可执行文件。</p><ul><li>预处理（preprocessing）：<code>gcc -E xxx.c -o xxx.i</code>，预处理器会在源码的基础上增加一些代码。</li><li>编译（compilation）：<code>gcc -S xxx.i -o xxx.s</code>，编译器通过编译代码（词法分析、语法分析等）得到汇编代码。</li><li>汇编（assemble）：<code>gcc -c xxx.s -o xxx.o</code>，汇编器把汇编代码转化为机器指令，这一步得到的是可重定位文件。</li><li>链接（link）：<code>gcc xxx.o -o xxx.elf</code>，连接器把各个模块链接起来，组织成为可执行文件。</li></ul><p>在链接中，会把函数的名字和变量的名字都称为符号（symbol）。源代码中的函数的名字和变量的名字，无论长度多少，最终都会转换为符号。</p><p>我在 {demo-c}/demo-in-linux/program/ 目录准备了五个文件。
hello_world.c、hello_world.i、hello_world.s、hello_world.o、hello_world.elf。
分别对应上面的源码文件，还有每个命令执行之后生成的文件。</p><h3 id=编译过程产生的几个文件>编译过程产生的几个文件</h3><p>首先，我们使用 file 命令，依次看一下这 5 个文件的文件类型。
关于 file 命令具体怎么用，可以看 &ldquo;file(1) - determine file type&rdquo;。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-text data-lang=text><span style=display:flex><span>&gt; file hello_world.c
</span></span><span style=display:flex><span>hello_world.c: C source, ASCII text, with CRLF line terminators
</span></span><span style=display:flex><span>&gt; file hello_world.i
</span></span><span style=display:flex><span>hello_world.i: C source, ASCII text
</span></span><span style=display:flex><span>&gt; file hello_world.s
</span></span><span style=display:flex><span>hello_world.s: assembler source, ASCII text
</span></span><span style=display:flex><span>&gt; file hello_world.o
</span></span><span style=display:flex><span>hello_world.o: ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), not stripped
</span></span><span style=display:flex><span>&gt; file hello_world.elf
</span></span><span style=display:flex><span>hello_world.elf: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=6d49e18a785eb53d246ca89c5dbce54472ed1584, for GNU/Linux 3.2.0, not stripped
</span></span></code></pre></div><p>这里解释一下。
hello_world.c 和 hello_world.i 都是 c 源码文件（C source）；
hello_world.s 是汇编源码文件（assembler source）；
hello_world.o 是可重定位文件（relocatable）；
hello_world.elf 是可执行文件（executable）。</p><p>特别注意一下 hello_world.elf，它的内容有点多的。
&ldquo;dynamically linked&rdquo; 表示它是动态链接的。
&ldquo;interpreter /lib64/ld-linux-x86-64.so.2&rdquo; 表示它有一个解释器，解释器的路径是 &ldquo;/lib64/ld-linux-x86-64.so.2&rdquo;。
这两个玩意，现在就解释有点太早了，在
<a href title="运行 ELF 文件">运行 ELF 文件</a> 这篇里面会详细的说。</p><p>这里，再用 objdump 命令观察一下 hello_world.o 文件的具体内容。
关于 objdump 命令具体怎么用。可以看 &ldquo;objdump(1) - display information from object files&rdquo;</p><p>这里会用到 &ldquo;-h&rdquo;、"-s"、"-d" 这几个参数。
&ldquo;-h&rdquo; 表示输出段表；"-s" 表示输出段表中每个段的详细内容；"-d" 表示输出 &ldquo;.text&rdquo; 段对应的汇编代码。
命令的输出我放在 {demo-c}/demo-in-linux/program/ 目录的 hello_world_objdump.md 文件内。</p><p>分别解释一下。</p><p>命令输出的结果的第一行都是 <code>hello_world.o: file format elf64-x86-64</code>，这个是文件的类型。</p><p>&ldquo;-h&rdquo; 输出的段表。</p><ul><li>&ldquo;.text&rdquo; 是代码段，它用于存储程序指令（程序的代码）；</li><li>&ldquo;.data&rdquo;、".bss"、".rodata" 都是数据段，它们用于存储程序数据；</li><li>&ldquo;.bss&rdquo; 是未初始化数据段；".rodata" 是只读数据段；</li></ul><p>&ldquo;-s&rdquo; 输出的段表中每个段的详细内容。这里截取了 &ldquo;.text&rdquo; 段。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-text data-lang=text><span style=display:flex><span>Contents of section .text:
</span></span><span style=display:flex><span> 0000 f30f1efa 554889e5 488d0500 00000048  ....UH..H......H
</span></span><span style=display:flex><span> 0010 89c7e800 000000b8 00000000 5dc3      ............].  
</span></span></code></pre></div><ul><li>左边第 1 列是虚拟地址，表示内存偏移量。</li><li>中间的 4 列是指令码，表示程序指令的内容（16 进制机器指令）。</li><li>最右边 1 列是 ASCII 码，是程序指令的 ASCII 文本。</li></ul><p>&ldquo;-d&rdquo; 输出的 &ldquo;.text&rdquo; 段对应的汇编代码。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-text data-lang=text><span style=display:flex><span>Disassembly of section .text:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>0000000000000000 &lt;main&gt;:
</span></span><span style=display:flex><span>   0:	f3 0f 1e fa          	endbr64 
</span></span><span style=display:flex><span>   4:	55                   	push   %rbp
</span></span><span style=display:flex><span>   5:	48 89 e5             	mov    %rsp,%rbp
</span></span><span style=display:flex><span>   8:	48 8d 05 00 00 00 00 	lea    0x0(%rip),%rax        # f &lt;main+0xf&gt;
</span></span><span style=display:flex><span>   f:	48 89 c7             	mov    %rax,%rdi
</span></span><span style=display:flex><span>  12:	e8 00 00 00 00       	call   17 &lt;main+0x17&gt;
</span></span><span style=display:flex><span>  17:	b8 00 00 00 00       	mov    $0x0,%eax
</span></span><span style=display:flex><span>  1c:	5d                   	pop    %rbp
</span></span><span style=display:flex><span>  1d:	c3                   	ret    
</span></span></code></pre></div><p>&ldquo;Disassembly of section .text&rdquo;，表示程序指令的内容，以及对应的汇编代码。这里和 &ldquo;-s&rdquo; 输出的结果对应。
上面 &ldquo;-s&rdquo; 输出的结果里的 &ldquo;Contents of section .text&rdquo; 里，第一行第二段的 &ldquo;f30f1efa&rdquo;，就对应这里的 &ldquo;0: f3 0f 1e fa&rdquo;。
下面一行的 &ldquo;4: 55&rdquo; 和后面的 &ldquo;push %rbp&rdquo;，就表示 &ldquo;55&rdquo;（0x55）反汇编后对应的汇编指令就是 &ldquo;push %rbp&rdquo;。</p><p>然后，再用 objdump 命令观察一下 hello_world.elf 文件。命令的输出也放在 hello_world_objdump.md 文件里面。
这里可以看到，hello_world.elf 的内容是比 hello_world.o 要多出不少的。</p><p>而且，通过 hello_world.elf 的内容，我们可以发现。</p><p>第一点：hello_world.elf 的 &ldquo;.text&rdquo; 段的第一个函数不是 main 函数，而是 &ldquo;_start&rdquo; 函数。
&ldquo;_start&rdquo; 函数会调用 &ldquo;__libc_start_main&rdquo; 函数进行一些必要的初始化操作，然后再调用 main 函数。
也就是说，main 函数并不是程序的入口。</p><p>第二点：一个简单的 hello world 程序没有看上去的那么简单。</p><h3 id=可执行文件>可执行文件</h3><p>关于 elf 可执行文件的详细的内容。我放到这篇里面去了。
<a href=/post/computer-science/operating-system/linux/elf title="ELF 文件">ELF 文件</a></p><h3 id=程序的运行过程是怎样的>程序的运行过程是怎样的</h3><p>关于 elf 可执行文件的运行过程的详细的内容。我放到这篇里面去了。
<a href=/post/computer-science/operating-system/linux/exec_elf title="运行 ELF 文件">运行 ELF 文件</a></p></div><footer class=post-footer><div class=post-tags><a href=/tags/computer-science%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%a7%91%e5%ad%a6>computer-science(计算机科学)</a>
<a href=/tags/operating-system%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f>operating-system(操作系统)</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right><ul><li class=post-copyright-title><strong>文章标题：</strong>
程序</li><li class=post-copyright-author><strong>本文作者：</strong>
西柊慧音</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=/post/computer-science/operating-system/program/ title=程序>/post/computer-science/operating-system/program/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/computer-science/operating-system/linux/elf/ rel=next title=ELF><i class="fa fa-chevron-left"></i> ELF</a></div><div class="post-nav-prev post-nav-item"><a href=/post/computer-science/operating-system/dynamically_statically_linked/ rel=prev title=动态链接和静态链接>动态链接和静态链接
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>西柊慧音</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.103.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.4.1 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"busuanzi":{"pageview":true},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"statis":{"enable":false,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.4.1","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.c997eeae723f2fcee19ae5066fcc64a49cefb92ddb75904efdb69a223e5a6740.js defer></script></body></html>