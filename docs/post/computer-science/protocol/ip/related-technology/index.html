<!doctype html><html lang=zh-cn data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.103.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="和 IP 相关的玩意，暂时放这里"><meta itemprop=description content><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/image/pid49256268.jpg"><meta itemprop=keywords content="computer-science(计算机科学),protocol(协议),ip"><meta property="og:type" content="article"><meta property="og:title" content="和 IP 相关的玩意，暂时放这里"><meta property="og:description" content><meta property="og:image" content="/image/pid49256268.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/post/computer-science/protocol/ip/related-technology/"><meta property="og:site_name" content="帕里特档案馆"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="西柊慧音"><meta property="article:published_time" content="2022-05-04 08:00:00 +0800 CST"><meta property="article:modified_time" content="2022-05-04 08:00:00 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.4da9279b6033ade10d67092d7bfb660265f9fa46c40974f17b13bfe235396546.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"related-technology","permalink":"/post/computer-science/protocol/ip/related-technology/","title":"和 IP 相关的玩意，暂时放这里","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>和 IP 相关的玩意，暂时放这里 - 帕里特档案馆</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>帕里特档案馆</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>重建中</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>107</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><ul><li><a href=#dns>DNS</a><ul><li><a href=#域名的层级关系>域名的层级关系</a></li><li><a href=#根域名>根域名</a></li><li><a href=#域名结构树>域名结构树</a></li><li><a href=#域名解析的工作流程>域名解析的工作流程</a></li><li><a href=#本地-dns-服务器的工作流程>本地 DNS 服务器的工作流程</a></li></ul></li><li><a href=#arp>ARP</a></li><li><a href=#rarp>RARP</a></li><li><a href=#dhcp>DHCP</a></li><li><a href=#nat-和-napt>NAT 和 NAPT</a></li><li><a href=#icmp>ICMP</a></li><li><a href=#igmp>IGMP</a></li><li><a href=#参考>参考</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=西柊慧音 src=/imgs/img-lazy-loading.gif data-src=/image/pid49256268.jpg><p class=site-author-name itemprop=name>西柊慧音</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>107</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>19</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>67</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/KelipuTe title="Github → https://github.com/KelipuTe" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span>
<span class=links-of-social-item><a href=xhy_1365@sina.com title="E-Mail → xhy_1365@sina.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>E-Mail</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/post/computer-science/protocol/ip/related-technology/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/image/pid49256268.jpg"><meta itemprop=name content="西柊慧音"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="西柊慧音"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="和 IP 相关的玩意，暂时放这里"><meta itemprop=description content="和 IP 相关的玩意，暂时放这里"></span><header class=post-header><h1 class=post-title itemprop="name headline">和 IP 相关的玩意，暂时放这里</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text>发表于：</span>
<time title="发表于：2022-05-04 08:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2022-05-04 08:00:00 +0800 CST">2022-05-04</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/protocol%E5%8D%8F%E8%AE%AE itemprop=url rel=index><span itemprop=name>protocol(协议)</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span><span>3486</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>7分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv data-path=/post/computer-science/protocol/ip/related-technology/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h3 id=dns>DNS</h3><p>DNS（Domain Name System、域名系统）是一个将域名和 IP 地址相互映射的分布式数据库。作用是把服务端域名解析到服务端的 IP 地址。DNS 服务主要是基于 UDP 实现的，服务器的端口号为 53。</p><h4 id=域名的层级关系>域名的层级关系</h4><p>DNS 中的域名是用句点（.）来分隔的，越靠右的位置表示其层级越高。整个域名的层级关系类似一个树状结构。</p><p>这里以百度的域名为例：www.baidu.com。最顶层是根域名，下一层是顶级域名（com），再下一层是权威域名（baidu.com）。</p><p>所有的 DNS 服务器都有根服务器的信息。所以，只要连上任意一台 DNS 服务器，就可以找到根服务器。然后，顺着树状结构就可以找到目标域名。</p><h4 id=根域名>根域名</h4><p>根域名是由一群服务器组成的，这群服务器用了 13 个不同的域名。从 a~m 开头，后面都是 <code>.root-servers.net</code>，如 a.root-servers.net。</p><p>13 个根域名由上千台根服务器（节点）组成，由 12 个独立机构运营。也就是说，绝大部分的根域名的节点的 IP 地址是一样的。通过任波技术，当向根服务器进行联系时，就能找到最近的根域名服务器。</p><ul><li>根域名服务器会管理 .com、.cn、.net 这些 TLD（Top Level Domain、顶级域名）服务器。</li><li>顶级域名服务器会管理各自的 Authoritative（权限域名）服务器也叫权威域名服务器。</li><li>权限域名服务器会管理各自的主机服务器。</li></ul><h4 id=域名结构树>域名结构树</h4><p>这里以 bilibili 的两个域名为例：www.bilibili.com 和 space.bilibili.com。www.bilibili.com 表示访问 bilibili 的主站。space.bilibili.com 表示访问 bilibili 的个人空间。</p><ul><li>.bilibili 是权威域名。www.bilibili.com 和 space.bilibili.com 都被 .bilibili 域名管理。</li><li>.com 是顶级域名。.bilibili 域名被 .com 域名管理。</li><li>.com 域名又是被根域名（.）管理的。但是，一般省略根域名。完整的域名应该是
<a href=https://www.bilibili.com title=www.bilibili.com rel="noopener external nofollow noreferrer" target=_blank class=exturl>www.bilibili.com
<i class="fa fa-external-link-alt"></i>
</a>.，后面还有个句点表示根域名，也就是 .root 。</li></ul><h4 id=域名解析的工作流程>域名解析的工作流程</h4><p>这里以浏览器为例。</p><p>第一步、浏览器会搜索浏览器的 DNS 缓存。</p><p>如果浏览器的 DNS 缓存中没有对应的域名，那么会搜索操作系统的 DNS 缓存。如果操作系统的 DNS 缓存中没有对应的域名，那么会搜索操作系统的 hosts 文件。如果 host 文件中没有对应的域名，那么进入第二步。</p><p>第二步、浏览器通过"客户端 DNS 解析器"，向"本地 DNS 服务器"发起域名解析请求。</p><p>本地 DNS 服务器一般由互联网服务提供商（ISP）负责管理，比如中国电信。客户端机器的操作系统的 TCP/IP 设置中，会配置一个本地 DNS 服务器。最后本地 DNS 服务器会将域名对应的 IP 地址返回给客户端。</p><p>客户端 DNS 解析器与本地 DNS 服务器之间使用递归方式传输。客户端 DNS 解析器发起请求之后，就等着本地 DNS 服务器返回结果。</p><h4 id=本地-dns-服务器的工作流程>本地 DNS 服务器的工作流程</h4><p>第一步、本地 DNS 服务器会查询自己的缓存。如果缓存里能找到就直接返回。</p><p>第二步、如果缓存里找不到，本地 DNS 服务器就会访问根服务器，请求查询
<a href=https://www.baidu.com title=www.baidu.com rel="noopener external nofollow noreferrer" target=_blank class=exturl>www.baidu.com
<i class="fa fa-external-link-alt"></i>
</a>。www.baidu.com 域名归 com 顶级域管理。所以，根服务器会返回顶级域服务器的地址。</p><p>本地 DNS 服务器在得到根服务器返回的地址后，继续访问顶级域服务器，请求查询
<a href=https://www.baidu.com title=www.baidu.com rel="noopener external nofollow noreferrer" target=_blank class=exturl>www.baidu.com
<i class="fa fa-external-link-alt"></i>
</a>。www.baidu.com 域名归 baidu.com 权威域管理。所以，顶级域服务器会返回权威域服务器的地址。</p><p>本地 DNS 服务器在得到顶级域服务器给的地址后，继续访问权威域服务器，请求查询
<a href=https://www.baidu.com title=www.baidu.com rel="noopener external nofollow noreferrer" target=_blank class=exturl>www.baidu.com
<i class="fa fa-external-link-alt"></i>
</a>。权威域服务器查询到结果后，将
<a href=https://www.baidu.com title=www.baidu.com rel="noopener external nofollow noreferrer" target=_blank class=exturl>www.baidu.com
<i class="fa fa-external-link-alt"></i></a> 对应的 IP 地址返回给本地 DNS 服务器。</p><p>本地 DNS 服务器和其他域名服务器之间使用迭代方式传输。本地 DNS 服务器会依次访问其他的域名服务器，最终得到 IP。</p><h3 id=arp>ARP</h3><p>ARP（Address Resolution Protocol、地址解析协议）的作用是根据 IP 地址获取 MAC 地址（物理地址）。</p><p>主机会以广播的形式发送 ARP 请求，这个请求中包含目标主机的 IP 地址。</p><p>同一个链路中的所有设备在收到 ARP 请求时都会拆开 ARP 请求包。如果请求包中的目标 IP 和自己的 IP 地址一致，就会将自己的 MAC 地址通过 ARP 响应包返回给主机。</p><p>主机在获取到 MAC 地址后，会将其缓存起来，下次会直接从缓存中获取。</p><h3 id=rarp>RARP</h3><p>RARP（Reverse Address Resolution Protocol、反向地址转换协议）的作用是根据已知的 MAC 地址获取 IP 地址。</p><p>RARP 通常需要架设一台服务器，在这个服务器上注册设备的 MAC 地址及其 IP 地址。其它设备向 RARP 服务器发送 RARP 请求包，然后 RARP 服务器通过 RARP 响应包返回 IP 地址。</p><h3 id=dhcp>DHCP</h3><p>DHCP（Dynamic HostConfigurationProtocol、动态主机配置协议）是一个应用层的局域网的网络协议。通过 DHCP 动态获取 IP 地址，省去了配置 IP 地址的过程。由服务器控制一段范围的 IP 地址，客户机登录服务器时就可以自动获得服务器分配的 IP 地址和子网掩码。</p><p>DHCP 全程使用 UDP 广播通信。客户端进程监听 68 端口，服务端进程监听 67 端口。</p><p>第一步、客户端发送 DHCP DISCOVER（DHCP 发现报文）的 IP 数据报。</p><p>由于客户端这个时候没有 IP 地址，也不知道 DHCP 服务端的 IP 地址，所以使用 UDP 广播进行通信。目标 IP 地址设置为广播地址 255.255.255.255:67，源 IP 地址设置为 0.0.0.0:68。报文主要携带一个事务 ID。</p><p>第二步、DHCP 服务端收到 DHCP 发现报文时，用 DHCP OFFER（DHCP 提供报文）响应客户端。</p><p>报文携带事务 ID、DHCP 服务器地址、可供租约的 IP 地址、子网掩码、默认网关、DNS 服务器、IP 地址租用期。使用 UDP 广播进行通信。目标 IP 地址设置为 255.255.255.255:68，源 IP 地址设置为自己的地址。</p><p>第三步、客户端收到一个获多个服务器提供的 DHCP 提供报文后，从中选择一个。然后向选中的服务器发送 DHCP REQUEST（DHCP 请求报文）进行响应。</p><p>报文携带事务 ID、DHCP 服务器地址、回传配置信息（租约的 IP 地址、租期等）。目标 IP 地址设置为 255.255.255.255:67，源 IP 地址设置为 0.0.0.0:68。</p><p>第四步、服务端收到 DHCP 请求报文后，用 DHCP ACK 响应客户端。</p><p>报文携带事务 ID、DHCP 服务器地址、确认配置信息（租约的 IP 地址、租期等）目标 IP 地址设置为 255.255.255.255:68，源 IP 地址设置为自己的地址。</p><p>当客户端和 DHCP 服务器不在一个局域网中时，由于路由器不会转发广播包，所以需要其他设备进行处理。这个设备就是 DHCP relay agent（中继代理），通过 DHCP 中继代理，一个 DHCP 服务器就可以对不同的网段进行 IP 地址分配。</p><p>当续约的 IP 地址到期时，客户端会向服务器发送 DHCP 请求报文。</p><ul><li>如果服务器同意继续租用，则用 DHCP ACK 进行应答。客户端可以延长租期继续使用 IP 地址。</li><li>如果服务器不同意继续租用，则用 DHCP NACK 进行应答。客户端就要停止使用 IP 地址。</li></ul><h3 id=nat-和-napt>NAT 和 NAPT</h3><p>简单地说 NAT（Network Address Translation、网络地址转换）就是同一组织、公司内的主机对外通信时，把私有 IP 转换成公有 IP。</p><p>转换方式有：</p><ul><li>Static Nat（静态转换）</li><li>Dynamic Nat（动态转换）</li><li>Over Load（端口多路复用）。</li></ul><p>NAPT（Network Address Port Translation、网络地址端口转换）</p><p>由于绝大多数的网络应用都是使用传输层的 TCP 或者 UDP。因此可以把内部的私有 IP转换成公有 IP + 端口的形式，然后生成一个 NAPT 路由转换表。路由器根据路由转换表，将从互联网收到的数据包分发给内网指定的机器。</p><p>NAT 和 NAPT 都需要依赖路由转换表。</p><ul><li>1、这意味着外部无法主动与内部机器建立连接。</li><li>2、维护转换表和进行转换操作都需要额外的性能开销。</li><li>3、一旦路由器重启，所有的 TCP 连接都会被重置。</li></ul><p>解决方案有两种：用 IPv6 或者 NAT 穿透技术。</p><p>NAT 穿透技术，能够让应用程序主动发现自己位于 NAT 设备之后。程序会主动获得 NAT 设备的公有 IP 并为自己建立端口映射。然后用这个映射对外通信。</p><h3 id=icmp>ICMP</h3><p>ICMP（Internet Control Message Protocol、互联网控制报文协议）是 TCP/IP 协议簇的一个子协议，用于在 IP 主机、路由器之间传递控制消息。控制消息是指网络通不通、主机是否可达、路由是否可用等网络本身的消息。</p><p>ICMP 主要的功能包括：</p><ul><li>确认 IP 包是否成功送达目标地址</li><li>报告发送过程中 IP 包被废弃的原因和改善网络设置等。</li></ul><p>在 IP 通信中如果某个 IP 包因为某种原因未能达到目标地址，那么这个具体的原因将由 ICMP 负责通知。</p><p>ICMP 大致可以分为两大类：</p><ul><li>查询报文类型，用于诊断的查询消息</li><li>差错报文类型，用于通知出错原因的错误消息。</li></ul><h3 id=igmp>IGMP</h3><p>主机与本地路由器之间使用 IGMP（Internet Group Management Protocol、因特网组管理协议）来进行组播组成员信息的交互，管理组播组成员的加入和离开。</p><p>主机 IP 软件需要进行组播扩展，才能使主机能够在本地网络上收发组播分组。但仅靠这一点是不够的，因为跨越多个网络的组播转发必须依赖于路由器。路由器为建立组播转发路由必需了解每个组员在 Internet 中的分布。这要求主机必须能将其所在的组播组通知给本地路由器。</p><h3 id=参考>参考</h3><ul><li><a href=https://xiaolincoding.com/ title=小林coding rel="noopener external nofollow noreferrer" target=_blank class=exturl>小林coding
<i class="fa fa-external-link-alt"></i></a><ul><li><a href=https://xiaolincoding.com/network/ title=图解网络 rel="noopener external nofollow noreferrer" target=_blank class=exturl>图解网络
<i class="fa fa-external-link-alt"></i></a></li></ul></li><li><a href=https://www.zhihu.com/question/23042131/answer/1683528809 title=DNS解析的过程是什么，求详细的？ rel="noopener external nofollow noreferrer" target=_blank class=exturl>DNS解析的过程是什么，求详细的？
<i class="fa fa-external-link-alt"></i></a></li></ul></div><footer class=post-footer><div class=post-tags><a href=/tags/computer-science%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%a7%91%e5%ad%a6>computer-science(计算机科学)</a>
<a href=/tags/protocol%e5%8d%8f%e8%ae%ae>protocol(协议)</a>
<a href=/tags/ip>ip</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right><ul><li class=post-copyright-title><strong>文章标题：</strong>
和 IP 相关的玩意，暂时放这里</li><li class=post-copyright-author><strong>本文作者：</strong>
西柊慧音</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=/post/computer-science/protocol/ip/related-technology/ title="和 IP 相关的玩意，暂时放这里">/post/computer-science/protocol/ip/related-technology/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/computer-science/protocol/ip/ip/ rel=next title="IP 协议"><i class="fa fa-chevron-left"></i> IP 协议</a></div><div class="post-nav-prev post-nav-item"><a href=/post/computer-science/protocol/tcp/tcp/ rel=prev title=TCP>TCP
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>西柊慧音</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.103.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.4.1 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"busuanzi":{"pageview":true},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"statis":{"enable":false,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.4.1","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.c997eeae723f2fcee19ae5066fcc64a49cefb92ddb75904efdb69a223e5a6740.js defer></script></body></html>