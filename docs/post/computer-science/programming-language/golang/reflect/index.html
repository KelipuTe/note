<!doctype html><html lang=zh-cn data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.103.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Golang 反射的基本使用方式"><meta itemprop=description content><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/image/pid49256268.jpg"><meta itemprop=keywords content="computer-science(计算机科学),programming-language(编程语言),golang,reflect(反射)"><meta property="og:type" content="article"><meta property="og:title" content="Golang 反射的基本使用方式"><meta property="og:description" content><meta property="og:image" content="/image/pid49256268.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/post/computer-science/programming-language/golang/reflect/"><meta property="og:site_name" content="帕里特档案馆"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="西柊慧音"><meta property="article:published_time" content="2023-05-22 08:00:00 +0800 CST"><meta property="article:modified_time" content="2023-05-22 08:00:00 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.4da9279b6033ade10d67092d7bfb660265f9fa46c40974f17b13bfe235396546.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"reflect","permalink":"/post/computer-science/programming-language/golang/reflect/","title":"Golang 反射的基本使用方式","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Golang 反射的基本使用方式 - 帕里特档案馆</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>帕里特档案馆</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>重建中</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>87</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#资料>资料</a></li><li><a href=#正文>正文</a><ul><li><a href=#实例>实例</a></li><li><a href=#反射>反射</a></li><li><a href=#基本类型>基本类型</a></li><li><a href=#arrayslicestring>array、slice、string</a></li><li><a href=#map>map</a></li><li><a href=#指针类型>指针类型</a><ul><li><a href=#一级指针>一级指针</a></li><li><a href=#多级指针>多级指针</a></li></ul></li><li><a href=#实例和指针的关系>实例和指针的关系</a></li><li><a href=#方法>方法</a></li><li><a href=#结构体>结构体</a><ul><li><a href=#结构体实例>结构体实例</a></li><li><a href=#结构体属性>结构体属性</a></li><li><a href=#结构体属性的-tag>结构体属性的 Tag</a></li><li><a href=#结构体方法>结构体方法</a></li></ul></li></ul></li><li><a href=#参考reference>参考（reference）</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=西柊慧音 src=/imgs/img-lazy-loading.gif data-src=/image/pid49256268.jpg><p class=site-author-name itemprop=name>西柊慧音</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>87</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>16</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>62</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/KelipuTe title="Github → https://github.com/KelipuTe" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span>
<span class=links-of-social-item><a href=xhy_1365@sina.com title="E-Mail → xhy_1365@sina.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>E-Mail</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/post/computer-science/programming-language/golang/reflect/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/image/pid49256268.jpg"><meta itemprop=name content="西柊慧音"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="西柊慧音"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Golang 反射的基本使用方式"><meta itemprop=description content="反射的基本使用方式；"></span><header class=post-header><h1 class=post-title itemprop="name headline">Golang 反射的基本使用方式</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text>发表于：</span>
<time title="发表于：2023-05-22 08:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-05-22 08:00:00 +0800 CST">2023-05-22</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/golang itemprop=url rel=index><span itemprop=name>golang</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span><span>3189</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>7分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv data-path=/post/computer-science/programming-language/golang/reflect/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=前言>前言</h2><ul><li>CPU AMD64(x86_64)</li><li>Windows 11 家庭版</li><li>go version go1.19 windows/amd64</li></ul><h2 id=资料>资料</h2><ul><li><a href=https://github.com/KelipuTe/demo-golang title={demo-golang} rel="noopener external nofollow noreferrer" target=_blank class=exturl>{demo-golang}
<i class="fa fa-external-link-alt"></i>
</a>/demo/reflectkn/</li><li><a href=/drawio/computer-science/programming-language/golang/reflect.drawio.html>reflect.drawio.html</a></li></ul><h2 id=正文>正文</h2><p>注意，笔记里的代码是伪代码，方便说明和区分用的。</p><h3 id=实例>实例</h3><p>在 Golang 中，一个实例（叫变量也行），它由类型信息和值信息组成。</p><p>比如：<code>var int a = 8</code>。a 就是一个实例，它的类型信息就是 int，值信息就是 8。</p><p>当然实际上没有这么简单，这里就是方便理解。</p><h3 id=反射>反射</h3><p>和反射相关的 API 都在 reflect 包里面。其中最核心的 API 有两个：reflect.Type() 和 reflect.Value()。</p><p>reflect 包有一个很强的假设，使用者知道他在干什么。比如，使用者知道他在操作的变量是什么类型的。</p><p>所以，在调用 API 之前一定要先读注释，确认什么样的情况下可以调用。如果调用的不对就会 panic。</p><p>reflect.Type() 可以用来操作类型信息，类型信息只能读取。比如，代码里定义了一个 int 实例，编译的时候这个实例肯定也是 int 的。</p><p>reflect.Value() 可以用来操作值信息，部分值信息可以修改。比如，私有变量就应该不能改，能改的话，就破坏私有变量的定义了。</p><p>另外，通过 reflect.Value() 可以获取 reflect.Type()，反过来则不行。</p><p>在计算机中数据都是存储在内存上的 0 和 1，既然 reflect.Value() 可以操作值信息，那么它就必须知道，数据在哪里，有多长。</p><p>如果没有类型信息，它就不知道要从内存上拿多长的数据。反过来则不行，只知道类型，不代表知道数据在哪。</p><h3 id=基本类型>基本类型</h3><p>基本类型比较简单了。比如，int 类型。</p><p>reflect.TypeOf(int).Kind() 直接就能拿到 reflect.Int 类型。</p><p>reflect.ValueOf(int).Interface() 直接就能拿到 interface{} 类型的值。再做一次类型断言，就可以得到 int 类型的值了。</p><p>代码示例：<strong>{demo-golang}/demo/reflectkn/int_test.c</strong></p><h3 id=arrayslicestring>array、slice、string</h3><p>这几个类型不能直接用 reflect.ValueOf(array).Interface()。</p><p>要先通过 reflect.ValueOf(array).Len() 拿到长度。然后，通过 reflect.ValueOf(array).Index(i) 拿到每一个元素。</p><p>拿到每一个元素之后，就可以通过 Index(i).Interface() 拿到具体的值了。</p><p>如果是多维数组的话，Index(i).Interface() 会拿到多维数组的元素。比如，二维数组，这里拿到的就是一维数组。</p><p>代码示例：</p><ul><li><strong>{demo-golang}/demo/reflectkn/array_test.c</strong></li><li><strong>{demo-golang}/demo/reflectkn/slice_test.c</strong></li><li><strong>{demo-golang}/demo/reflectkn/string_test.c</strong></li></ul><h3 id=map>map</h3><p>map 类型是单独一类的处理方法，可以使用 reflect.ValueOf(map).Len() 拿到长度。但是，不能用下标进行遍历。遍历方式有两种。</p><p>第一种是先通过 reflect.ValueOf(map).MapKeys() 拿到所有的键，通过遍历所有的键，去一个一个找值。</p><p>MapKeys() 会返回一个值信息的切片，可以配合 Len() 拿到的长度，就可以通过下标访问每一个键。</p><p>把拿到的键传给 reflect.ValueOf(map).MapIndex(键)，就可以拿到键对应的值的值信息。</p><p>这样 reflect.ValueOf(map).MapIndex(键).Interface() 就可以拿到具体的值了。</p><p>第二种是通过 reflect.ValueOf(map).MapRange() 拿到一个有点像单链表的可以遍历的结构。</p><p>然后，一个一个处理就好了。通过 t4MapRange.Next() 判断元素有没有遍历到头，有的话会返回 true。</p><p>然后，用 t4MapRange.Key().Interface() 可以拿到键，用 t4MapRange.Value().Interface() 可以拿到值。</p><p>这就处理完一个键值对了，然后，再调用 t4MapRange.Next() 判断元素有没有遍历到头，有的话继续。</p><p>代码示例：<strong>{demo-golang}/demo/reflectkn/map_test.c</strong></p><h3 id=指针类型>指针类型</h3><p>指针类型会麻烦一点，有两种情况，第一种是一级指针，第二种是多级指针。比如，*int 类型和 **int 类型。</p><p>指针类型的 reflect.Type() 和 reflect.Value() 都可以使用 Elem()，分别拿到各自解引用后的结果。</p><p>代码示例：<strong>{demo-golang}/demo/reflectkn/int_test.c</strong></p><h4 id=一级指针>一级指针</h4><p>比如，*int 类型。</p><p>reflect.TypeOf(*int).Kind() 拿到的类型是 reflect.Pointer。</p><p>reflect.TypeOf(*int).Elem().Kind() 拿到的类型才是 reflect.Int。</p><p>reflect.ValueOf(*int).Elem().Interface() 直接就能拿到 interface{} 类型的值。</p><p>因为，Elem() 已经相当于解引用了，所以，这里直接就能拿到具体的值。</p><h4 id=多级指针>多级指针</h4><p>比如，**int 类型。需要连续进行 Elem()，直到拿到具体的类型。</p><p>reflect.TypeOf(**int).Elem().Kind() 拿到的类型是 reflect.Pointer。</p><p>也就是说，对 **int 的类型信息进行 Elem()，拿到的是 *int 的类型，还是个 reflect.Pointer。</p><p>要再来一次 Elem()，也就是 reflect.TypeOf(**int).Elem().Elem().Kind() 拿到的类型才是 reflect.Int。</p><p>多级指针的这个过程可以用循环去处理。最后和一级指针一样，通过 Interface() 就能拿到 interface{} 类型的值。</p><h3 id=实例和指针的关系>实例和指针的关系</h3><p>见图：<strong>reflect.drawio.html 2-2</strong></p><h3 id=方法>方法</h3><p>方法本身是可以匿名进行调用的，就像下面这样。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>testFunc := func() {
</span></span><span style=display:flex><span>    fmt.Println(&#34;testFunc&#34;)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>testFunc()
</span></span></code></pre></div><p>这种方式处理有入参和出参的方法是很麻烦的，在调用的时候，必须知道变量里存的到底是什么类型的方法。如果方法的类型在不一样，那就基本没办法处理了。</p><p>这个时候，就需要用到反射了。通过反射，可以知道一个方法的入参和出参分别有几个，分别是什么类型的。</p><p>知道了这些，就可以根据方法的入参，构造对应的参数传入，也可以根据方法的出参，构造对应的参数来接收。</p><p>比如，糙一点的用法。可以通过 reflect.TypeOf(func).NumIn() 知道方法有几个入参。</p><p>然后，构造一个入参切片 <code>inputSlice := make([]reflect.Value, num)</code>，把所有的参数用 reflect.ValueOf(参数) 转换成反射的值类型，放进去。</p><p>再构造一个出参切片 <code>outputSlice := make([]reflect.Value, 0)</code>。然后，就可以调用方法了 <code>outputSlice = reflect.ValueOf(func).Call(inputSlice)</code>。</p><p>代码示例：</p><ul><li><strong>{demo-golang}/demo/reflectkn/func.c</strong></li><li><strong>{demo-golang}/demo/reflectkn/func_test.c</strong></li></ul><h3 id=结构体>结构体</h3><p>关于结构体的反射有两个部分，一部分是和结构体实例有关系的，一部分是和结构体本身有关系的（属性和方法）。</p><p>代码示例：</p><ul><li><strong>{demo-golang}/demo/reflectkn/struct.c</strong></li><li><strong>{demo-golang}/demo/reflectkn/struct_test.c</strong></li></ul><h4 id=结构体实例>结构体实例</h4><p>结构体实例有两种情况，第一种直接就是结构体、第二种是结构体指针。</p><p>如果直接就是结构体的话，reflect.TypeOf(struct).Kind() 得到的是 reflect.Struct 类型。</p><p>如果直接就是结构体指针的话，处理方式和上面指针类型那里是一样的。</p><h4 id=结构体属性>结构体属性</h4><p>通过 reflect.TypeOf() 和 reflect.ValueOf() 先拿到结构体的类型信息和值信息。</p><p>然后，通过 reflect.TypeOf(struct).NumField() 可以拿到结构体属性的数量。</p><p>知道数量之后，就可以通过 reflect.TypeOf(struct).Field(i) 和 reflect.ValueOf(struct).Field(i)，分别获取每一个属性的类型信息和值信息。</p><p>需要注意的是，私有属性是拿不到值信息的，只能拿到类型信息。通过 reflect.TypeOf(struct).Field(i).IsExported() 可以判断是不是私有属性。</p><p>reflect.TypeOf(struct).Field(i).Name 可以获取属性的名称，reflect.Zero(reflect.TypeOf(struct).Field(i).Type).Interface() 可以用类型信息构造零值。</p><p>反射还可以用来修改属性的值。很多框架都需要用到，通过属性名称找到并修改属性值，这样的操作。</p><p>reflect.TypeOf(struct).FieldByName(属性名称) 这样就可以通过属性名称，找到对应的属性的值信息。注意，这里通过结构体的类型信息，找到的是属性的值信息。</p><p>然后，用 reflect.TypeOf(struct).FieldByName(属性名称).CanSet() 可以用来判断属性能不能进行赋值操作。</p><p>如果可以的话，可以通过 reflect.TypeOf(struct).FieldByName(属性名称).Set(reflect.ValueOf(属性值)) 把值放进去。</p><p>其中 reflect.ValueOf(属性值) 这个部分，就是把具体的数据类型转换成反射使用的数据类型。</p><h4 id=结构体属性的-tag>结构体属性的 Tag</h4><p>通过 reflect.TypeOf(struct).Field(i).Tag 就可以拿到结构体某个属性上的 Tag，这里拿到的是 reflect.StructTag。</p><p>然后，在通过 reflect.StructTag 的 Get() 方法，就可以拿到整个 Tag 里面某个具体的 Tag 的内容了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>type User struct {
</span></span><span style=display:flex><span>	Id  int  `orm:&#34;column_name=user_id&#34;`
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>比如，对于 User 的 Id 属性来说，Field(i).Tag.Get(orm) 就会拿到字符串 &ldquo;column_name=user_id&rdquo;。</p><h4 id=结构体方法>结构体方法</h4><p>结构体方法的处理方式，是结构体属性的处理方式和方法的处理方式相结合。</p><p>先通过 reflect.TypeOf(struct).NumMethod() 知道结构体有几个方法。</p><p>然后，就可以通过下标进行遍历了。reflect.TypeOf(struct).Method(i) 这样就能拿到方法的类型信息。</p><p>Method(i).NumIn() 和 Method(i).NumOut() 分别可以拿到方法的入参数量和出参数量。</p><p>Method(i).Type.In(i) 和 Method(i).Type.Out(i) 分别可以拿到方法每个入参的参数类型和每个出参的参数类型。</p><p>调用结构体方法和调用方法那里有点区别 <code>outSlice = Method(i).Func.Call(inputSlice)</code>。</p><h2 id=参考reference>参考（reference）</h2><ul><li>{极客时间}/
<a href=https://u.geekbang.org/subject/go2nd title="Go 实战训练营" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Go 实战训练营
<i class="fa fa-external-link-alt"></i></a><ul><li>反射部分</li></ul></li></ul></div><footer class=post-footer><div class=post-tags><a href=/tags/computer-science%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%a7%91%e5%ad%a6>computer-science(计算机科学)</a>
<a href=/tags/programming-language%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80>programming-language(编程语言)</a>
<a href=/tags/golang>golang</a>
<a href=/tags/reflect%e5%8f%8d%e5%b0%84>reflect(反射)</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right><ul><li class=post-copyright-title><strong>文章标题：</strong>
Golang 反射的基本使用方式</li><li class=post-copyright-author><strong>本文作者：</strong>
西柊慧音</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=/post/computer-science/programming-language/golang/reflect/ title="Golang 反射的基本使用方式">/post/computer-science/programming-language/golang/reflect/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/computer-science/operating-system/linux/exec_elf/ rel=next title="运行 ELF 文件"><i class="fa fa-chevron-left"></i> 运行 ELF 文件</a></div><div class="post-nav-prev post-nav-item"><a href=/post/computer-science/programming-language/golang/rpc/ rel=prev title="Golang 实现简单的自定义 RPC 协议">Golang 实现简单的自定义 RPC 协议
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>西柊慧音</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.103.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.4.1 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"busuanzi":{"pageview":true},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"statis":{"enable":false,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.4.1","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.c997eeae723f2fcee19ae5066fcc64a49cefb92ddb75904efdb69a223e5a6740.js defer></script></body></html>