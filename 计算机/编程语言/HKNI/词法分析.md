~~---
draft: false
date: 2024-03-02 08:00:00 +0800
title: "HKNI 的词法分析"
summary: "HKNI 解释性强类型语言的词法分析；"
toc: true

categories:

- 编程语言

tags:

- 计算机科学
- 编程语言

---

## 正文

词法分析主要完成读取源代码和识别符号这两个任务。

### 语法

下面是 HKNI 解释型强类型语言提供的语法。

语句必须以分号结尾。

#### 数据类型

空（null）。

```
null;
```

整数（int）。支持：二进制（0b）、八进制（0）、十进制、十六进制（0x）。

```
0b10;
010;
10;
0x10;
```

浮点数（float）。支持：十进制。

```
3.14;
```

布尔值（bool）。支持：true、false。

```

```

字符串（string）。支持：''、""、``。支持转义字符。

```
"ab"; //ab
"a'b'"; //a'b'
"a\"b\""; //a"b"
"a\\b"; //a\b
"a\\nb"; //a\nb
```

#### 运算

算数运算符。支持：负号（-）、加（+）、减（-）、乘（*）、除（/）、取余（%）。

```
-2;
2+2;2-2;
2*2;2/2;
2%2;
2+2*2;
```

通过小括号（()）改变优先级、前缀自增运算符（++）、前缀自减运算符（--）。

```
(2+2)*2;
++i;--i;
```

位运算符。支持：按位与（&）、按位或（|）。

```
0b01 & 0b10;
0b01 | 0b10;
```

逻辑运算符。支持：与（&&）、或（||）、非（!）。

```
true && false;
a && b;
true || false;
a || b;
!true;
!a;
```

关系运算符。支持：等于（==）、不等于（!=）、大于（>）、大于等于（>=）、小于（<）、小于等于（<=）。

```
2 == 2;a == 2;a == b;
2 != 2;a == 2;a == b;
2 >  2;a >  2;a >  b;
2 >= 2;a >= 2;a >= b;
2 <  2;a <  2;a <  b;
2 <= 2;a <= 2;a <= b;
```

#### 变量声明

```
var 标识符 类型;
```

```
var a int;
```

#### 赋值运算

赋值运算符。支持：=、+=、-=、*=、/=、%=。

```
标识符 赋值运算符 值;
```

```
a = 2;a = b;
```

#### 变量声明并赋值

```
var 标识符 类型 = 值; 
```

```
var a int = 2;
```

#### 常量声明

```
const 标识符 类型 = 值;
```

```
const a int = 2;
```

#### 选择结构

```
if (条件表达式) {块语句} else {块语句}

```

```
//只有 if 分支。
if (a == 2) {
    b = 10;
}
//有 if 分支和 else 分支。
if (a == 2) {
    b = 10;
} else {
    b = 20;
} 
```

#### 循环结构

```
for (初始化表达式;循环条件表达式;循环后操作表达式) {块语句}
```

```
//初始化表达式中没声明新变量。
var i int;
var j int = 2;
for (i = 0;i < 10;++i) {
    j+=1;
}

//初始化表达式中有声明新变量。
var j int = 2;
for (var int i = 0;i < 10;++i) {
    j+=1;
}
```

#### 函数（方法）声明

```
func 标识符(参数表) 返回值类型 {块语句}
参数表 => 标识符 类型, 标识符 类型...
```

```
func f() {} //没有入参，没有返回值。
func f(a int) {} //有入参，没有返回值。
func f(a int, b int) {} //有 2 个入参，没有返回值。
func f() int {} //没有入参，有返回值。
func f(a int) int {} //有入参，有返回值。
```

#### 函数（方法）调用

```
标识符(参数表);
```

```
f();
f(1);f(1,2);
f(a);f(a,b);
f(g());f(g(),b());
f(1,a,g());
```

#### 返回

```
return 值;
```

```
return;
return 2;return 2+2;
return a;return a+b;
return f();return f()+g();
```

### 内置函数

```
println("hello world") //调用 c++ 的 std::cout
```

#### 数组

```
var 标识符 类型[数组长度];
```

里面是用 c++ 的 std::map 实现的。

#### map

```
var 标识符 map[键类型]值类型;
```

里面是用 c++ 的 std::map 实现的。

#### 结构体声明

```
type 结构体标识符 struct {
    标识符 类型,
    标识符 类型,
    ...
}
```

```
func (结构体标识符) func 标识符(参数表) 返回值类型 {块语句}
```

#### 结构体实例化

```
结构体标识符 标识符 = new 结构体标识符();
```

### 符号

从上述提供的语法中就可以得到里面的主要符号。



