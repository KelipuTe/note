---
draft: false
date: 2023-07-15 08:00:00 +0800
title: "整数"
summary: "整数的范围；四则运算；自增自减；逻辑运算；位移运算；"
toc: true

categories:
  - 汇编语言

tags:
  - 计算机
  - 编程语言
  - 汇编语言
---

## 反向链接

[原码反码补码](/计算机/原码反码补码)；

## 正文

### 整数的范围

1 字节，8 位，可以表示 2^8 = 256 个数字。

有符号整形，0xff ~ 0x7f，-128 ~ 127。

2 字节，16 位，可以表示 2^16 = 65,535 个数字。

有符号整形，0xffff ~ 0x7fff，-32,768 ~ 32,767。

4 字节，32 位，可以表示 2^32 = 4,294,967,295 个数字。

有符号整形，0xffff,ffff ~ 0x7fff,ffff，-2,147,483,648 ~ 2,147,483,647。

8 字节，64 位，可以表示 2^64= 18,446,744,073,709,551,616 个数字。

有符号整形，0xffff,ffff,ffff,ffff ~ 0x7fff,ffff,ffff,ffff，9,223,372,036,854,775,808 ~ 9,223,372,036,854,775,807。

### 四则运算

#### add

add，实现整数的加法运算。

add 会自动分析操作数是有符号还是无符号。
有符号运算结果溢出（正数太大）时 of=1，无符号运算结果产生进位时 cf=1。

#### adc

adc，实现整数的加法运算。用法和 add 一样。

adc 除了用目标操作数加源操作数，还会再额外加一个当前的 cf 标志位（1 或者 0）。

#### sub

sub，实现整数的减法运算。用目标操作数减源操作数。

sub 会自动分析操作数是有符号还是无符号。
有符号运算结果溢出（负数太小）时 of=1，无符号运算结果产生借位时 cf=1。

#### sbb

sbb，实现整数的减法运算。用法和 sub 一样。

sbb 除了用目标操作数减源操作数，还会再额外减一个当前的 cf 标志位（1 或者 0）。

#### mul

mul，实现无符号整数的乘法运算。

目标操作数要先放到 rax、eax、ax、al 里面去。

如果运算结果过大，目标操作数寄存器放不下的话，会把运算结果拆成两部分。
如果是 64 位的运算结果过大，高 64 位放到 rdx，低 64 位放到 rax。

比如，无符号的 0xffff,ffff 已经把 eax 塞满了。这个时候再 x2，其结果 0x1,ffff,fffe 需要 33 位的空间。
eax 不够放了，这个时候就会把数据拆成两部分。高 32 位（0x1）放在 edx，低 32 位（0xffff,fffe）放在 eax。

#### imul

imul，实现有符号整数的乘法运算。该指令有 3 种形式，取决于操作数的数量。

单操作数形式，`imul {源操作数}`。用法与 mul 指令相同。

双操作数形式，`imul {目的操作数}, {源操作数}`。
执行源操作数和目的操作数的有符号乘法运算。结果会被截断，并存储在目的操作数。

三操作数形式，`imul {立即数}, {源操作数}, {目的操作数}`。
执行立即数和源操作数的有符号乘法运算。结果会被截断，并存储在目的操作数。

#### div

div 可以实现无符号整数的除法运算。

#### idiv

idiv 可以实现有符号整数的除法运算。

### 自增自减

- inc，在目标操作数上加 1，同时保留 cf 标志的状态。
- dec，从目标操作数中减去 1，同时保留 cf 标志的状态。

这两条指令允许在不影响 cf 标志的情况下更新循环计数器。

### 逻辑运算

- and，与运算。
- or，或运算。
- not，非运算。
- xor，异或运算。

### 移位运算

#### 左移

sal，算术左移。shl，逻辑左移。`sal {计数操作数}, {目的操作数}`。

它们执行相同的操作。将目标操作数中的位向左移动计数操作数中指定的位数。
移位后，超出目标操作数左边界的位，会先移入 cf 标志。

最低有效位（the least significant bit）被清零。

#### 右移

sar，算术右移。shr，逻辑右移。`sar {计数操作数}, {目的操作数}`。

它们执行相同的操作。将目标操作数中的位向右移动计数操作数中指定的位数。
移位后，超出目的操作数右边界的位，会先移入 cf 标志。

最高有效位（the most significant bit）根据指令类型被置位或清零。

#### 计数操作数

计数操作数可以是立即数或者 cl 寄存器。

计数操作数，在 32 位模式下，被屏蔽为 5 位，在 64 位模式下，被屏蔽为 6 位。
也就是说，计数的范围，在 32 位模式下，限制为 0 至 31，在 64 位模式下，限制为 0 至 63。
