
### 本地缓存和一致性哈希

正常情况下，如果你使用本地缓存，那么同一个 key 对应的请求，可能会被打到不同的节点上。这就会造成两个问题，一个是严重的缓存未命中，一个是不同节点都要缓存同样的数据，导致内存浪费和极其严重的数据一致性问题。

所以在这种情况下，一个很自然的想法就是能不能把类似的请求都让同一个节点来处理。比如说对某个用户数据的请求都打到同一个节点上。显然适合的负载均衡算法就两个：哈希或者一致性哈希。

如果我们考虑节点可能上线、下线的情况，那么一致性哈希负载均衡就是最优选择。

当整个集群的节点数量发生变化的时候，就难免会导致同样的数据缓存在多个节点上。
而应用发布是引起节点数量变化最常见的原因。毕竟应用发布可以看作先下线一个节点，再上线一个节点。

不过同时也可以看出来，在本地缓存结合了一致性哈希负载均衡算法之后数据一致性的问题已经被大大缓解了。