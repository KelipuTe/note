---
draft: true
date: 2022-08-01 08:00:00 +0800
title: "段式管理"
summary: "段式管理；"
toc: true

categories:
  - 操作系统

tags:
  - 计算机科学
  - 操作系统
  - 内存
---

## 正文

图：/content/计算机/operating-system/段式管理.drawio

### 段式管理

程序的内存空间由若干个逻辑分段组成。
如：代码分段、数据分段、栈段、堆段等。（**见图：段式管理.drawio**）

虚拟地址由段选择子和段内偏移量两部分组成。

段选择子保存在段寄存器。段选择子里的段号用作段表的索引。
段表保存段基地址、段界限和特权等级等。（**见图：段式管理.drawio**）

虚拟地址中的段内偏移量应该位于 0 和段界限之间，如果段内偏移量是合法的，就将段基地址加上段内偏移量得到物理内存地址。

#### 段式管理的不足

段式管理的不足主要有两点：1、内存碎片；2、内存交换的效率低。

内存碎片有两种：

- 外部碎片：多个不连续的小物理内存，导致新的程序由于内存不够无法被装载。
- 内部碎片：程序所有的数据都被装载到了物理内存，但是这个程序有部分的数据可能并不是很常使用，这会导致内存的浪费。

内存交换可以解决外部碎片的问题。可以把程序占用的内存写到硬盘上，然后再从硬盘上读回到内存。
在 Linux 中，内存交换空间（Swap 空间），这块空间是从硬盘划分出来的，用于内存与硬盘的空间交换。

对于多进程的系统来说，用分段的方式，很容易产生内存碎片。内存交换又受硬盘速度限制，效率低。
