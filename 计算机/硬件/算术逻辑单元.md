---
draft: false
date: 2023-02-21 08:00:00 +0800
title: "算术逻辑单元"
summary: "算术逻辑单元；"
toc: true

categories:
  - 硬件

tags:
  - 计算机
  - 硬件
---

## 反向链接

[算术单元](/计算机/硬件/算术单元)；
[逻辑单元](/计算机/硬件/逻辑单元)；

## 资料

图：./算术逻辑单元.drawio

## 正文

### 算术逻辑单元

- 算术逻辑单元、arithmetic and logic unit、ALU；
- 操作码、operation code；
- 标志位、flag；溢出标志、overflow；零测试电路、zero；负标志、negative；

算术逻辑单元由算术单元和逻辑单元组成。
主要工作是进行算数运算和逻辑运算。

ALU 一般都会支持的 8 个操作：

- 加法（add）
- 带进位的加法（add with carry）
- 减法（subtract）
- 带借位的减法（subtract with borrow）
- 取消（negate）
- 增量（increment、可以理解为 +1）
- 减量（decrement、可以理解为 -1）
- 数字无改变通过（pass through）

简单的 ALU 没有乘法和除法，乘法通过多次的加法实现。
高级的 ALU 有专门做乘法的算术单元。

ALU 有三个输入和多个输出。

三个输入分别是两个数据和一个操作码。操作码用于指示 ALU 做什么操作。

多个输出分别是一个数据输出和多个标志输出。
标志输出有很多。比如：overflow、zero、negative，这三个是普遍使用的。

这里的操作码其实就是指令的一部分。

### ALU 示意图

这里画一个简单的 ALU 的示意图，**见图：算术逻辑单元.drawio**。真正的 ALU 会有更多的东西。

这里的抽象示意图对应的是一个可以处理两个 8 位二进制数的算术运算的 ALU。

- 两个数据输入：两个二进制数。
- 一个操作码输入：加法、减法等。
- 一个数据输出：算数运算的结果。
- 3 个标志位输出：overflow 是否溢出、zero 是否为 0、negative 是否为负。

### 举几个例子

#### 0b11111111 + 0b11111111

加法器的进位输出连接到溢出标志，如果溢出标志输出 true，表示有溢出。

两个数据输入是 0b11111111 和 0b11111111、操作码输入假设是 0b0001（表示加法）。

0b11111111 + 0b11111111 = 0b1,11111110，溢出了。
所以数据输出是 0b11111110、overflow 是 1。

#### 0b11111111 == 0b11111111

计算机不会直接比较两个数字哪个大哪个小。
计算机用的思路是让两个数字相减，然后和 0 比较。

计算 A-B，如果零测试电路输出 true，表示 A 和 B 相等。

两个数据输入是 0b11111111 和 0b11111111、操作码输入假设是 0b0002（表示减法）。

因为 0b11111111 - 0b11111111 = 0b00000000，为 0。
所以数据输出是 0b00000000、zero 是 1。表示相等。

#### 0b11111111 < 0b11111110

和减法的思路一样。计算 A-B，如果负标志输出 true，表示 A 小于 B。

两个数据输入是 0b11111111 和 0b11111110、操作码输入假设是 0b0002（表示减法）。

因为 0b11111111 - 0b11111110 = 0b00000001，大于 0。
所以数据输出是 0b00000001、negative 是 0。表示 0b11111111 更大。
