---
draft: false
date: 2022-01-24 08:00:00 +0800
title: "进程跟踪"
summary: "进程跟踪；"
toc: true

categories:
  - 操作系统

tags:
  - 计算机科学
  - 操作系统
---

## 反向链接

[进程的资源](/post/computer-science/operating-system/linux/进程的资源)；
[函数](/post/computer-science/programming-language/assembly/函数)；

## 进程跟踪

在用 ptrace 跟踪另外一个进程，寻找目标数据时，
可能会在目标进程内存中多个位置找到目标数据，可能会有3个地方。

- 变量本体，就是变量所在的位置；
- 堆栈框架，比如当这个变量定义在main函数里面的时候，main函数的堆栈框架里也可能会出现；
- 寄存器，在执行过程中，数据可能会暂时存储在 cpu 的寄存器中；

当使用 ptrace 读取和修改目标进程的内存时，需要注意，读取和写入数据的单位是一个 long。
读取的时候想要读的是一个 int，但是返回的时候会带着这个 int 后面的四个字节。

修改的时候也需要注意，先把目标位置上的 8 个字节读出来。
然后修改需要修改的部分，然后把八个字节完整的放回去，要不然会出错。
